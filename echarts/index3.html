<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>柱状图</title>
</head>

<body>

    <div id="gdp" style="width: 100%;height: 900px;float: left;"></div>

    <script src="./js/echarts.js"></script>
    <script src="./js/jquery.js"></script>
    <script>
        var gdp = echarts.init(document.getElementById('gdp'));


        $.getJSON('./data/country_data.json', function (data) {

            var labelOption = {
                normal: {
                    show: true,
                    formatter: '{c}',
                    fontSize: 16,
                    rich: {
                        name: {
                            textBorderColor: '#fff'
                        }
                    }
                }
            };

            var country = [];
            var country_data = [];
            for (var index in data) {
                country.push(index);
                var gdp_avg = 0;
                var ec_avg = 0;
                data[index].forEach(element => {
                    gdp_avg += element.gdp;
                    ec_avg += element.ec;
                });
                country_data.push({
                    name: index,
                    name1: 'GDP',
                    type: 'bar',
                    label: labelOption,
                    color: '#003366',
                    data: [Math.round(gdp_avg / 43)]
                    
                }, {
                    name: index,
                    name1: 'EC',
                    type: 'bar',
                    label: labelOption,
                    data: [Math.round(ec_avg / 43)],
                    color: '#4cabce',
                    yAxisIndex: 1,
                });
            }
            
            console.log(country_data)

            option = {
                xAxis: [{
                    type: 'category'
                }, {
                    type: 'category'
                }],
                yAxis: [{
                    type: 'value'
                }, {
                    type: 'value'
                }],
                legend: {
                    type: 'scroll',
                    orient: 'vertical',
                    right: 10,
                    top: 20,
                    bottom: 20,
                    data: country,
                    selected: {
                        "Argentina": false,
                        "Australia": false,
                        "Brazil": false,
                        "Canada": false,
                        "China": false,
                        "Dem. Rep. Congo": false,
                        "Germany": false,
                        "Spain": false,
                        "Ethiopia": false,
                        "Finland": false,
                        "France": false,
                        "United Kingdom": false,
                        "Indonesia": false,
                        "India": false,
                        "Iraq": false,
                        "Iceland": false,
                        "Israel": false,
                        "Italy": false,
                        "Japan": false,
                        "Dem. Rep. Korea": false,
                        "Kuwait": false,
                        "Luxembourg": false,
                        "Morocco": false,
                        "Mexico": false,
                        "Norway": false,
                        "Nepal": false,
                        "Pakistan": false,
                        "Qatar": false,
                        "Russia": false,
                        "Saudi Arabia": false,
                        "Sweden": false,
                        "Syria": false,
                        "Trinidad and Tobago": false,
                        "Turkey": false,
                        "United States": false,
                        "Zimbabwe": false
                    }
                },
                grid: [{
                    right:'15%'
                }, {
                    right:'15%'
                }],
                series: country_data
            };

            gdp.setOption(option);

        });
    </script>
    </script>

</body>

</html>