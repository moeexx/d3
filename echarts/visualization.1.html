<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>visualization</title>
    <style>
        body {
            margin: 0;
        }
    </style>
</head>

<body>

    <!-- map -->
    <div>
        <div id="map" style="width: 100%;height: 900px;float: left;"></div>
    </div>

    <!-- line -->
    <div>
        <div id="line"></div>
    </div>

    <!-- bar -->
    <div>
        <div id="bar"></div>
    </div>

    <!-- line group -->
    <div>
        <div id="line_group"></div>
    </div>

    <script src="./js/echarts.js"></script>
    <script src="./js/echarts-gl.min.js"></script>
    <script src="./js/world.js"></script>
    <script src="./js/jquery.js"></script>
    <script>
        const map = echarts.init(document.getElementById('map')),
            line = echarts.init(document.getElementById('line')),
            bar = echarts.init(document.getElementById('bar')),
            line_group = echarts.init(document.getElementById('line_group'));

        // year
        const year = ['1971', '1972', '1973', '1974', '1975', '1976', '1977', '1978', '1979',
            '1980', '1981', '1982', '1983', '1984', '1985', '1986', '1987', '1988', '1989',
            '1990', '1991', '1992', '1993', '1994', '1995', '1996', '1997', '1998', '1999',
            '2000', '2001', '2002', '2003', '2004', '2005', '2006', '2007', '2008', '2009',
            '2010', '2011', '2012', '2013', '2014'
        ];
        // country
        const country = ['Argentina', 'Australia', 'Brazil', 'Canada', 'China', 'Dem Rep. Congo', 'Germany', 'Spain',
            'Ethiopia', 'Finland', 'France', 'United Kingdom', 'Indonesia', 'India', 'Iraq', 'Iceland', 'Israel',
            'Italy', 'Japan', 'Dem Rep. Korea', 'Kuwait', 'Luxembourg', 'Morocco', 'Mexico', 'Norway', 'Nepal',
            'Pakistan', 'Qatar', 'Russia', 'Saudi Arabia', 'Sweden', 'Syria', 'Trinidad and Tobago', 'Turkey',
            'United States', 'Zimbabwe'
        ];

        $.getJSON('./data/year_data.json', function (data) {

            const light = {
                main: {
                    intensity: 1,
                    shadow: true,
                    shadowQuality: 'low',
                    alpha: 50
                },
                ambientCubemap: {
                    texture: './data/canyon.hdr',
                    diffuseIntensity: 0.4
                }
            };
            const postEffect = {
                enable: true,
                bloom: {
                    enable: false
                },
                depthOfField: {
                    enable: false,
                    focalRange: 10,
                    blurRadius: 10,
                    fstop: 1
                },
                SSAO: {
                    radius: 1,
                    intensity: 1,
                    enable: true
                }
            };

            map_option = {
                timeline: {
                    axisType: 'category',
                    orient: 'horizontal',
                    autoPlay: false,
                    playInterval: 500,
                    loop: false,
                    data: year
                },
                baseOption: {
                    series: [{
                        type: 'map3D',
                        map: 'world',
                        width: '50%',
                        regionHeight: 0.1,
                        viewControl: {
                            distance: 85,
                            panMouseButton: 'left',
                            rotateMouseButton: 'right'
                        },
                        groundPlane: {
                            show: true,
                            color: '#999'
                        },
                        light: light,
                        postEffect

                    }, {
                        type: 'map3D',
                        map: 'world',
                        width: '50%',
                        left: '50%',
                        regionHeight: 0.1,
                        viewControl: {
                            distance: 85,
                            panMouseButton: 'left',
                            rotateMouseButton: 'right'
                        },
                        groundPlane: {
                            show: true,
                            color: '#999'
                        },
                        light: light,
                        postEffect

                    }],
                    visualMap: [{
                        gridIndex: 0,
                        min: 0,
                        max: 120000,
                        text: ['High', 'Low'],
                        calculable: false,
                        realtime: false,
                        inRange: {
                            color: ['#313695', '#4575b4', '#74add1', '#abd9e9', '#e0f3f8',
                                '#ffffbf', '#fee090', '#fdae61', '#f46d43', '#d73027',
                                '#a50026'
                            ]
                        }
                    }, {
                        min: 0,
                        max: 20000,
                        right: '0',
                        text: ['High', 'Low'],
                        calculable: false,
                        realtime: false,
                        inRange: {
                            color: ['#313695', '#4575b4', '#74add1', '#abd9e9', '#e0f3f8',
                                '#ffffbf', '#fee090', '#fdae61', '#f46d43', '#d73027',
                                '#a50026'
                            ]
                        }
                    }]
                },
                options: [{

                }]
            }

            for (var index in data) {
                var gdp_data = [];
                var ec_data = [];
                data[index].forEach(element => {
                    gdp_data.push({
                        name: element.country,
                        value: element.gdp,
                        height: element.gdp / 5000 + 0.1,
                        gridIndex: 1
                    });
                    ec_data.push({
                        name: element.country,
                        value: element.ec,
                        height: element.ec / 5000 + 0.1
                    });
                });
                map_option.options.push({
                    series: {
                        data: gdp_data
                    }
                });
            }

            map.setOption(map_option);


        });

        // $.getJSON('./data/country_data.json', function (data) {
        //     console.log(data);
        // });
    </script>
</body>

</html>